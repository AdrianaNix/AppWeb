<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}"
      lang="es">
    <head>
        <meta charset="UTF-8">
        <title>Dónde estamos – Electrosa</title>
        <link rel="stylesheet" th:href="@{/assets/css/practica7.css}">
        <link rel="stylesheet" th:href="@{/assets/css/practica8.css}">

        <!-- Leaflet CSS -->
        <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
              integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
              crossorigin=""/>

        <meta name="viewport"
              content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-4Q6Gf2aSP4eDXB8Miphtr37CMZZQ5oXLH2yaXMJ2w8e2ZtHTl7GptT4jmndRuHDT" crossorigin="anonymous">

    </head>
    <body>
        <main layout:fragment="main-content">
            <div class="product-container">
                <div class="container">
                    <div class="product-box">
                        <div class="product-featured">
                            <h1 class="title">Dónde estamos</h1>
                            <div id="map-container">
                                <div id="map"></div>
                            </div>

                            <button id="btn-geoloc">Dónde estoy</button>

                            <article>
                                <div class="accordion" id="accordionExample">
                                    <div th:each="almacen, iterStat : ${almacenes}" class="accordion-item">
                                        <h2 class="accordion-header" th:attr="id='heading' + ${almacen.codigo}">
                                            <button class="accordion-button"
                                                    th:classappend="${iterStat.index != 0} ? ' collapsed'"
                                                    type="button"
                                                    data-bs-toggle="collapse"
                                                    th:attr="data-bs-target='#collapse' + ${almacen.codigo}, aria-labelledby='heading' + ${almacen.codigo}"
                                                    th:attrappend="aria-expanded=${iterStat.index == 0}, aria-controls='collapse' + ${almacen.codigo}">
                                                <span th:text="'Almacén zona ' + ${almacen.zona}">Título</span>
                                            </button>

                                        </h2>
                                        <div class="accordion-collapse collapse"
                                             th:classappend="${iterStat.index == 0} ? ' show'"
                                             th:attr="id='collapse' + ${almacen.codigo}"
                                             data-bs-parent="#accordionExample"
                                             th:attrappend="aria-labelledby='heading' + ${almacen.codigo}">
                                            <div class="accordion-body">
                                                <p th:text="${almacen.calle}">Calle</p>
                                                <p th:text="${almacen.ciudad}">Ciudad</p>
                                                <p th:text="${almacen.cp} + ', ' +${almacen.provincia}">Dirección</p>

                                                <p><strong>Coordenadas:</strong> <span th:text="${almacen.coordX}+ ', ' +${almacen.coordY}"></span></p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </article>



                        </div>
                    </div>

                    <aside class="sidebar sidebar-boxd">
                        <h3>Más información</h3>
                        <div class="line">
                            <ion-icon name="bookmark-outline"></ion-icon>
                            <a href="#">Contacto</a>
                        </div>
                        <div class="line">
                            <ion-icon name="bookmark-outline"></ion-icon>
                            <a href="#">Nuestro equipo</a>
                        </div>
                        <div class="line">
                            <ion-icon name="bookmark-outline"></ion-icon>
                            <a href="#">Mapa del sitio</a>
                        </div>
                    </aside>
                </div>
            </div>
        </main>

    <th:block layout:fragment="scripts">
        <!-- Leaflet JS -->
        <script
            src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
            integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
        crossorigin></script>

        <script th:inline="javascript">
            const almacenes = /*[[${almacenes}]]*/ [];
        </script>

        <script th:src="@{/assets/js/mapa.js}" defer></script>

    </th:block>
    <th:block th:fragment="body-bottom">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.6/dist/js/bootstrap.bundle.min.js" integrity="sha384-j1CDi7MgGQ12Z7Qab0qlWQ/Qqz24Gc6BM0thvEMVjHnfYGF0rmFCozFSxQBxwHKO" crossorigin="anonymous"></script>
    </th:block>

</body>
</html>
